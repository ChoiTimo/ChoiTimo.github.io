<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartWAN Win/Loss Analysis Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .tab-container {
            display: flex;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 30px;
            gap: 5px;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1em;
            transition: all 0.3s ease;
            color: #64748b;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .section h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }

        .form-group select,
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group select:focus,
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .outcome-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .outcome-card {
            padding: 20px;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .outcome-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .outcome-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .outcome-card.win {
            border-color: #48bb78;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }

        .outcome-card.loss {
            border-color: #f56565;
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
        }

        .outcome-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .outcome-label {
            font-size: 1.2em;
            font-weight: 600;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .checkbox-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin-right: 12px;
            transform: scale(1.2);
        }

        .checkbox-item.checked {
            border-color: #667eea;
            background: linear-gradient(135deg, #ebf8ff 0%, #dbeafe 100%);
        }

        .rating-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .rating-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .rating-label {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .rating-scale {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
        }

        .rating-scale input[type="range"] {
            flex: 1;
            margin: 0 15px;
            height: 6px;
            border-radius: 5px;
            background: #e2e8f0;
            outline: none;
        }

        .rating-scale input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .rating-value {
            font-weight: bold;
            color: #667eea;
            min-width: 30px;
            text-align: center;
        }

        .analyze-btn {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 40px auto;
            box-shadow: 0 5px 15px rgba(72, 187, 120, 0.3);
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(72, 187, 120, 0.4);
        }

        .results {
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 15px;
            border: 2px solid #e2e8f0;
            display: none;
        }

        .results.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .insight-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
        }

        .insight-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .insight-title::before {
            content: attr(data-icon);
            margin-right: 10px;
            font-size: 1.2em;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border-top: 4px solid #667eea;
        }

        .metric-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .metric-label {
            color: #64748b;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .metric-change {
            font-size: 0.8em;
            font-weight: 600;
        }

        .metric-change.positive {
            color: #48bb78;
        }

        .metric-change.negative {
            color: #f56565;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .chart-title {
            text-align: center;
            color: #2d3748;
            margin-bottom: 20px;
            font-weight: 600;
            font-size: 1.2em;
        }

        .bar-chart {
            display: flex;
            align-items: end;
            height: 200px;
            gap: 15px;
            margin: 20px 0;
            padding: 0 20px;
        }

        .bar {
            flex: 1;
            background: linear-gradient(to top, #667eea, #a78bfa);
            border-radius: 5px 5px 0 0;
            position: relative;
            min-height: 20px;
            display: flex;
            align-items: end;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
            padding-bottom: 10px;
        }

        .bar.win {
            background: linear-gradient(to top, #48bb78, #68d391);
        }

        .bar.loss {
            background: linear-gradient(to top, #f56565, #fc8181);
        }

        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8em;
            font-weight: 600;
            color: #4a5568;
            text-align: center;
        }

        .action-items {
            background: #f0fff4;
            border: 2px solid #c6f6d5;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .action-title {
            color: #22543d;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            font-size: 1.2em;
        }

        .action-title::before {
            content: "🎯";
            margin-right: 10px;
        }

        .action-list {
            list-style: none;
            padding-left: 0;
        }

        .action-list li {
            padding: 12px 0;
            border-bottom: 1px solid #c6f6d5;
            position: relative;
            padding-left: 30px;
        }

        .action-list li::before {
            content: "→";
            position: absolute;
            left: 0;
            color: #48bb78;
            font-weight: bold;
            font-size: 1.2em;
        }

        .action-list li:last-child {
            border-bottom: none;
        }

        .priority-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.7em;
            font-weight: 600;
            margin-left: 10px;
        }

        .priority-high {
            background: #f56565;
            color: white;
        }

        .priority-medium {
            background: #ed8936;
            color: white;
        }

        .priority-low {
            background: #48bb78;
            color: white;
        }

        .warning-box {
            background: #fef5e7;
            border: 2px solid #f6e05e;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .warning-title {
            color: #d69e2e;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .warning-title::before {
            content: "⚠️";
            margin-right: 8px;
        }

        .competitor-analysis {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }

        .competitor-analysis table {
            width: 100%;
            border-collapse: collapse;
        }

        .competitor-analysis th {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .competitor-analysis td {
            padding: 12px 15px;
            border-bottom: 1px solid #e5e7eb;
        }

        .competitor-analysis tr:nth-child(even) {
            background: #f9fafb;
        }

        .trend-indicator {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .trend-up {
            background: #dcfce7;
            color: #166534;
        }

        .trend-down {
            background: #fee2e2;
            color: #dc2626;
        }

        .trend-stable {
            background: #fef3c7;
            color: #92400e;
        }

        @media (max-width: 768px) {
            .container {
                margin: 0;
                border-radius: 0;
            }
            
            .content {
                padding: 20px;
            }
            
            .tab-container {
                flex-direction: column;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .outcome-selector {
                grid-template-columns: 1fr;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr;
            }
            
            .rating-group {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📊 SmartWAN Win/Loss Analysis</h1>
            <p>영업 성과를 체계적으로 분석하여 지속적인 개선을 이끌어내는 전략적 도구</p>
        </div>

        <div class="content">
            <div class="tab-container">
                <button class="tab active" onclick="showTab('input')">📝 딜 분석</button>
                <button class="tab" onclick="showTab('insights')">🔍 인사이트</button>
                <button class="tab" onclick="showTab('trends')">📈 트렌드</button>
                <button class="tab" onclick="showTab('reports')">📋 리포트</button>
            </div>

            <!-- 딜 분석 입력 탭 -->
            <div id="input" class="tab-content active">
                <div class="section">
                    <h3>🏢 딜 기본 정보</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customer-name">고객사명</label>
                            <input type="text" id="customer-name" placeholder="예: 삼성전자, SK텔레콤">
                        </div>
                        
                        <div class="form-group">
                            <label for="deal-size">딜 사이즈 (억원)</label>
                            <input type="number" id="deal-size" min="0.1" step="0.1" placeholder="예: 15.5">
                        </div>
                        
                        <div class="form-group">
                            <label for="sales-cycle">영업 사이클 (개월)</label>
                            <input type="number" id="sales-cycle" min="1" max="36" placeholder="예: 6">
                        </div>
                        
                        <div class="form-group">
                            <label for="industry">업종</label>
                            <select id="industry">
                                <option value="">업종 선택</option>
                                <option value="manufacturing">제조업</option>
                                <option value="financial">금융업</option>
                                <option value="enterprise">기업서비스</option>
                                <option value="public">공공/준공공</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="sales-rep">담당 영업</label>
                            <input type="text" id="sales-rep" placeholder="담당자명">
                        </div>
                        
                        <div class="form-group">
                            <label for="close-date">마감일</label>
                            <input type="date" id="close-date">
                        </div>
                        
                        <div class="form-group">
                            <label for="primary-competitor">주요 경쟁사</label>
                            <select id="primary-competitor">
                                <option value="">경쟁사 선택</option>
                                <option value="cisco">Cisco</option>
                                <option value="fortinet">Fortinet</option>
                                <option value="paloalto">Palo Alto</option>
                                <option value="cato">Cato Networks</option>
                                <option value="others">기타</option>
                                <option value="none">경쟁 없음</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="decision-maker">주요 의사결정자</label>
                            <select id="decision-maker">
                                <option value="">의사결정자 선택</option>
                                <option value="cio">CIO/IT본부장</option>
                                <option value="ciso">CISO/보안팀장</option>
                                <option value="it-manager">IT팀장/관리자</option>
                                <option value="cfo">CFO/재무팀장</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>🎯 딜 결과</h3>
                    <p style="margin-bottom: 20px; color: #718096;">이번 딜의 최종 결과를 선택해주세요.</p>
                    
                    <div class="outcome-selector">
                        <div class="outcome-card" onclick="selectOutcome('win')">
                            <div class="outcome-icon">🏆</div>
                            <div class="outcome-label">WON</div>
                            <div style="font-size: 0.9em; margin-top: 5px; opacity: 0.7;">계약 성사</div>
                        </div>
                        
                        <div class="outcome-card" onclick="selectOutcome('loss')">
                            <div class="outcome-icon">❌</div>
                            <div class="outcome-label">LOST</div>
                            <div style="font-size: 0.9em; margin-top: 5px; opacity: 0.7;">계약 실패</div>
                        </div>
                        
                        <div class="outcome-card" onclick="selectOutcome('no-decision')">
                            <div class="outcome-icon">⏸️</div>
                            <div class="outcome-label">NO DECISION</div>
                            <div style="font-size: 0.9em; margin-top: 5px; opacity: 0.7;">결정 연기/보류</div>
                        </div>
                    </div>
                </div>

                <div class="section" id="win-factors" style="display: none;">
                    <h3>🏆 성공 요인 분석</h3>
                    <p style="margin-bottom: 20px; color: #718096;">이번 딜 성공에 기여한 주요 요인들을 선택해주세요. (복수 선택 가능)</p>
                    
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="win-price" value="competitive-price">
                            <label for="win-price">💰 경쟁력 있는 가격</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="win-tech" value="technical-superiority">
                            <label for="win-tech">🚀 기술적 우수성</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="win-relationship" value="strong-relationship">
                            <label for="win-relationship">🤝 고객과의 신뢰 관계</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="win-support" value="excellent-support">
                            <label for="win-support">🛠️ 뛰어난 기술 지원</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="win-roi" value="clear-roi">
                            <label for="win-roi">📊 명확한 ROI 제시</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="win-timing" value="perfect-timing">
                            <label for="win-timing">⏰ 적절한 타이밍</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="win-reference" value="strong-reference">
                            <label for="win-reference">⭐ 강력한 레퍼런스</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="win-demo" value="effective-demo">
                            <label for="win-demo">🎬 효과적인 데모/PoC</label>
                        </div>
                    </div>
                </div>

                <div class="section" id="loss-factors" style="display: none;">
                    <h3>❌ 실패 요인 분석</h3>
                    <p style="margin-bottom: 20px; color: #718096;">이번 딜 실패의 주요 원인들을 선택해주세요. (복수 선택 가능)</p>
                    
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="loss-price" value="price-too-high">
                            <label for="loss-price">💸 가격 경쟁력 부족</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="loss-features" value="missing-features">
                            <label for="loss-features">🔧 필수 기능 부족</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="loss-relationship" value="weak-relationship">
                            <label for="loss-relationship">😔 고객 관계 부족</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="loss-competitor" value="strong-competitor">
                            <label for="loss-competitor">💪 강력한 경쟁사</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="loss-timing" value="bad-timing">
                            <label for="loss-timing">⏱️ 부적절한 타이밍</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="loss-budget" value="budget-constraints">
                            <label for="loss-budget">💳 예산 제약</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="loss-decision" value="unclear-decision-process">
                            <label for="loss-decision">❓ 불분명한 의사결정 구조</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="loss-trust" value="trust-issues">
                            <label for="loss-trust">🤷 신뢰성 우려</label>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>⭐ 영업 프로세스 평가</h3>
                    <p style="margin-bottom: 20px; color: #718096;">이번 딜에서의 영업 프로세스를 1-10점으로 평가해주세요.</p>
                    
                    <div class="rating-group">
                        <div class="rating-item">
                            <div class="rating-label">리드 발굴 및 초기 접근</div>
                            <div class="rating-scale">
                                <span>1</span>
                                <input type="range" min="1" max="10" value="5" id="rating-lead">
                                <span>10</span>
                                <div class="rating-value" id="rating-lead-value">5</div>
                            </div>
                        </div>
                        
                        <div class="rating-item">
                            <div class="rating-label">니즈 분석 및 Discovery</div>
                            <div class="rating-scale">
                                <span>1</span>
                                <input type="range" min="1" max="10" value="5" id="rating-discovery">
                                <span>10</span>
                                <div class="rating-value" id="rating-discovery-value">5</div>
                            </div>
                        </div>
                        
                        <div class="rating-item">
                            <div class="rating-label">솔루션 제안 및 데모</div>
                            <div class="rating-scale">
                                <span>1</span>
                                <input type="range" min="1" max="10" value="5" id="rating-proposal">
                                <span>10</span>
                                <div class="rating-value" id="rating-proposal-value">5</div>
                            </div>
                        </div>
                        
                        <div class="rating-item">
                            <div class="rating-label">가격 협상 및 조건 합의</div>
                            <div class="rating-scale">
                                <span>1</span>
                                <input type="range" min="1" max="10" value="5" id="rating-negotiation">
                                <span>10</span>
                                <div class="rating-value" id="rating-negotiation-value">5</div>
                            </div>
                        </div>
                        
                        <div class="rating-item">
                            <div class="rating-label">관계 구축 및 신뢰 형성</div>
                            <div class="rating-scale">
                                <span>1</span>
                                <input type="range" min="1" max="10" value="5" id="rating-relationship">
                                <span>10</span>
                                <div class="rating-value" id="rating-relationship-value">5</div>
                            </div>
                        </div>
                        
                        <div class="rating-item">
                            <div class="rating-label">클로징 및 계약 체결</div>
                            <div class="rating-scale">
                                <span>1</span>
                                <input type="range" min="1" max="10" value="5" id="rating-closing">
                                <span>10</span>
                                <div class="rating-value" id="rating-closing-value">5</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>💬 추가 피드백</h3>
                    
                    <div class="form-group">
                        <label for="customer-feedback">고객 피드백 (고객이 직접 언급한 내용)</label>
                        <textarea id="customer-feedback" placeholder="고객이 직접 언급한 우리 솔루션에 대한 피드백, 우려사항, 긍정적 평가 등을 기록해주세요..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="lessons-learned">배운 점 및 개선사항</label>
                        <textarea id="lessons-learned" placeholder="이번 딜을 통해 배운 점, 다음에 다르게 해야 할 점, 개선이 필요한 부분 등을 자유롭게 작성해주세요..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="next-actions">후속 조치 계획</label>
                        <textarea id="next-actions" placeholder="성공 시: 확장 기회, 레퍼런스 활용 계획 등 / 실패 시: 재접근 계획, 관계 유지 방안 등을 작성해주세요..."></textarea>
                    </div>
                </div>

                <button class="analyze-btn" onclick="analyzeDeal()">
                    📊 딜 분석 수행하기
                </button>

                <div class="results" id="analysisResults">
                    <div id="analysisContent"></div>
                </div>
            </div>

            <!-- 인사이트 탭 -->
            <div id="insights" class="tab-content">
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value">73%</div>
                        <div class="metric-label">전체 Win Rate</div>
                        <div class="metric-change positive">+5% vs 지난 분기</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">4.2개월</div>
                        <div class="metric-label">평균 영업 사이클</div>
                        <div class="metric-change negative">+0.5개월 vs 지난 분기</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">12.5억</div>
                        <div class="metric-label">평균 딜 사이즈</div>
                        <div class="metric-change positive">+2.1억 vs 지난 분기</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">8.2</div>
                        <div class="metric-label">평균 영업 프로세스 점수</div>
                        <div class="metric-change positive">+0.3 vs 지난 분기</div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">업종별 Win Rate 분석</div>
                    <div class="bar-chart">
                        <div class="bar win" style="height: 85%;">
                            85%
                            <div class="bar-label">제조업</div>
                        </div>
                        <div class="bar win" style="height: 70%;">
                            70%
                            <div class="bar-label">금융업</div>
                        </div>
                        <div class="bar win" style="height: 78%;">
                            78%
                            <div class="bar-label">기업서비스</div>
                        </div>
                        <div class="bar win" style="height: 65%;">
                            65%
                            <div class="bar-label">공공/준공공</div>
                        </div>
                    </div>
                </div>

                <div class="insight-card">
                    <div class="insight-title" data-icon="💡">핵심 인사이트</div>
                    <ul>
                        <li><strong>제조업 강세:</strong> 제조업에서 85% Win Rate로 가장 높은 성과. 해외 법인 네트워크 이슈가 핵심 동기</li>
                        <li><strong>영업 사이클 증가:</strong> 평균 영업 사이클이 0.5개월 증가. 의사결정 과정 복잡화 추세</li>
                        <li><strong>딜 사이즈 성장:</strong> 평균 딜 사이즈 17% 증가로 상향 판매 전략 효과</li>
                        <li><strong>경쟁사 변화:</strong> Cisco 대비 우위 확대, Palo Alto 경쟁 심화</li>
                    </ul>
                </div>

                <div class="competitor-analysis">
                    <table>
                        <thead>
                            <tr>
                                <th>경쟁사</th>
                                <th>대결 횟수</th>
                                <th>Win Rate</th>
                                <th>주요 승부처</th>
                                <th>트렌드</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Cisco</strong></td>
                                <td>23건</td>
                                <td>78%</td>
                                <td>가격, 국내 지원</td>
                                <td><span class="trend-indicator trend-up">↗ 개선</span></td>
                            </tr>
                            <tr>
                                <td><strong>Fortinet</strong></td>
                                <td>15건</td>
                                <td>73%</td>
                                <td>성능, 사용 편의성</td>
                                <td><span class="trend-indicator trend-stable">→ 유지</span></td>
                            </tr>
                            <tr>
                                <td><strong>Palo Alto</strong></td>
                                <td>18건</td>
                                <td>61%</td>
                                <td>비용 효율성</td>
                                <td><span class="trend-indicator trend-down">↘ 악화</span></td>
                            </tr>
                            <tr>
                                <td><strong>Cato Networks</strong></td>
                                <td>12건</td>
                                <td>83%</td>
                                <td>현지화, 지연시간</td>
                                <td><span class="trend-indicator trend-up">↗ 개선</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="warning-box">
                    <div class="warning-title">주의 필요 영역</div>
                    <ul>
                        <li><strong>Palo Alto 경쟁 심화:</strong> 최근 3개월간 Win Rate 15% 하락, 대응 전략 필요</li>
                        <li><strong>공공 부문 부진:</strong> 65% Win Rate로 타 업종 대비 저조, 접근 방식 재검토 필요</li>
                        <li><strong>영업 사이클 지연:</strong> 의사결정 과정 복잡화로 인한 딜 지연 증가</li>
                    </ul>
                </div>
            </div>

            <!-- 트렌드 탭 -->
            <div id="trends" class="tab-content">
                <div class="chart-container">
                    <div class="chart-title">월별 Win/Loss 트렌드</div>
                    <div class="bar-chart">
                        <div class="bar win" style="height: 70%;">
                            70%
                            <div class="bar-label">1월</div>
                        </div>
                        <div class="bar win" style="height: 75%;">
                            75%
                            <div class="bar-label">2월</div>
                        </div>
                        <div class="bar win" style="height: 68%;">
                            68%
                            <div class="bar-label">3월</div>
                        </div>
                        <div class="bar win" style="height: 82%;">
                            82%
                            <div class="bar-label">4월</div>
                        </div>
                        <div class="bar win" style="height: 77%;">
                            77%
                            <div class="bar-label">5월</div>
                        </div>
                        <div class="bar win" style="height: 73%;">
                            73%
                            <div class="bar-label">6월</div>
                        </div>
                    </div>
                </div>

                <div class="insight-card">
                    <div class="insight-title" data-icon="📈">트렌드 분석</div>
                    <h4 style="margin-bottom: 15px;">📊 영업 성과 패턴</h4>
                    <ul style="margin-bottom: 20px;">
                        <li><strong>계절성:</strong> 4월이 Win Rate 82%로 최고 성과 (신규 예산 시즌)</li>
                        <li><strong>분기 마감 효과:</strong> 3월, 6월 등 분기 마감월에 Win Rate 소폭 하락</li>
                        <li><strong>성장 추세:</strong> 전반적으로 상승 트렌드 유지</li>
                    </ul>

                    <h4 style="margin-bottom: 15px;">🎯 성공 요인 변화</h4>
                    <ul style="margin-bottom: 20px;">
                        <li><strong>기술 우수성 → ROI 중심:</strong> 최근 고객들이 명확한 투자 수익률을 요구</li>
                        <li><strong>관계 기반 영업 강화:</strong> 신뢰 관계가 성사 확률을 30% 높임</li>
                        <li><strong>레퍼런스 효과 증대:</strong> 동일 업종 레퍼런스가 있는 경우 Win Rate 20% 상승</li>
                    </ul>

                    <h4 style="margin-bottom: 15px;">⚠️ 주요 실패 요인</h4>
                    <ul>
                        <li><strong>가격 경쟁력:</strong> 전체 실패 사례의 35%가 가격 이슈</li>
                        <li><strong>의사결정 지연:</strong> 28%가 고객 내부 의사결정 과정 지연으로 실패</li>
                        <li><strong>경쟁사 우위:</strong> 22%가 경쟁사의 더 나은 조건으로 실패</li>
                    </ul>
                </div>

                <div class="action-items">
                    <div class="action-title">개선 액션 플랜</div>
                    <ul class="action-list">
                        <li>가격 경쟁력 강화를 위한 번들 상품 개발 <span class="priority-badge priority-high">HIGH</span></li>
                        <li>의사결정 가속화를 위한 임원진 직접 접촉 프로세스 구축 <span class="priority-badge priority-high">HIGH</span></li>
                        <li>업종별 특화 레퍼런스 영상 및 사례 개발 <span class="priority-badge priority-medium">MEDIUM</span></li>
                        <li>ROI 계산기 정확도 향상 및 활용도 제고 <span class="priority-badge priority-medium">MEDIUM</span></li>
                        <li>Palo Alto 경쟁 대응 전용 배틀카드 업데이트 <span class="priority-badge priority-high">HIGH</span></li>
                        <li>공공 부문 전담 영업팀 구성 검토 <span class="priority-badge priority-low">LOW</span></li>
                    </ul>
                </div>
            </div>

            <!-- 리포트 탭 -->
            <div id="reports" class="tab-content">
                <div class="insight-card">
                    <div class="insight-title" data-icon="📋">분기별 Win/Loss 리포트</div>
                    
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-value">87건</div>
                            <div class="metric-label">총 분석 딜 수</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">64건</div>
                            <div class="metric-label">성공 딜 (WON)</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">18건</div>
                            <div class="metric-label">실패 딜 (LOST)</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">5건</div>
                            <div class="metric-label">연기 딜 (NO DECISION)</div>
                        </div>
                    </div>

                    <h4 style="margin: 25px 0 15px 0;">🏆 주요 성과</h4>
                    <ul style="margin-bottom: 25px;">
                        <li><strong>목표 대비 성과:</strong> 분기 목표 대비 112% 달성</li>
                        <li><strong>대형 딜 성과:</strong> 10억원 이상 대형 딜 8건 성사</li>
                        <li><strong>신규 고객:</strong> 23개 신규 고객사 확보</li>
                        <li><strong>확장 매출:</strong> 기존 고객 확장을 통한 매출 35억원 추가</li>
                    </ul>

                    <h4 style="margin: 25px 0 15px 0;">🎯 업종별 성과 요약</h4>
                    <div class="competitor-analysis">
                        <table>
                            <thead>
                                <tr>
                                    <th>업종</th>
                                    <th>딜 수</th>
                                    <th>Win Rate</th>
                                    <th>평균 딜 사이즈</th>
                                    <th>총 매출 기여</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>제조업</td>
                                    <td>28건</td>
                                    <td>85%</td>
                                    <td>15.2억원</td>
                                    <td>362억원</td>
                                </tr>
                                <tr>
                                    <td>기업서비스</td>
                                    <td>23건</td>
                                    <td>78%</td>
                                    <td>12.8억원</td>
                                    <td>230억원</td>
                                </tr>
                                <tr>
                                    <td>금융업</td>
                                    <td>21건</td>
                                    <td>70%</td>
                                    <td>18.5억원</td>
                                    <td>272억원</td>
                                </tr>
                                <tr>
                                    <td>공공/준공공</td>
                                    <td>15건</td>
                                    <td>65%</td>
                                    <td>8.9억원</td>
                                    <td>87억원</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h4 style="margin: 25px 0 15px 0;">💪 팀 성과 분석</h4>
                    <ul style="margin-bottom: 25px;">
                        <li><strong>Top Performer:</strong> 김영업 (Win Rate 92%, 딜 12건)</li>
                        <li><strong>Most Improved:</strong> 이신입 (전분기 대비 Win Rate 25% 향상)</li>
                        <li><strong>Big Deal Winner:</strong> 박시니어 (25억원 딜 성사)</li>
                        <li><strong>신규 개척:</strong> 정파이터 (신규 고객 7건 확보)</li>
                    </ul>

                    <h4 style="margin: 25px 0 15px 0;">🔍 다음 분기 전망</h4>
                    <ul>
                        <li><strong>파이프라인:</strong> 125건, 1,250억원 규모 진행 중</li>
                        <li><strong>예상 Win Rate:</strong> 현재 트렌드 기준 75% 예상</li>
                        <li><strong>리스크 요소:</strong> 경쟁 심화, 예산 승인 지연</li>
                        <li><strong>기회 요소:</strong> 신제품 출시, 대형 고객 RFP 예정</li>
                    </ul>
                </div>

                <div class="action-items">
                    <div class="action-title">팀 차원 개선 계획</div>
                    <ul class="action-list">
                        <li>월 2회 Win/Loss 리뷰 세션 정례화 <span class="priority-badge priority-high">HIGH</span></li>
                        <li>베스트 프랙티스 공유를 위한 내부 wiki 구축 <span class="priority-badge priority-medium">MEDIUM</span></li>
                        <li>신입 영업 대상 멘토링 프로그램 강화 <span class="priority-badge priority-medium">MEDIUM</span></li>
                        <li>경쟁사 대응 전문가 양성 과정 신설 <span class="priority-badge priority-high">HIGH</span></li>
                        <li>고객 만족도 조사 정례화 (분기 1회) <span class="priority-badge priority-low">LOW</span></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedOutcome = '';
        let dealData = {};

        function showTab(tabName) {
            // 모든 탭 비활성화
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // 모든 탭 컨텐츠 숨기기
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // 선택된 탭 활성화
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        function selectOutcome(outcome) {
            selectedOutcome = outcome;
            
            // 모든 outcome 카드 초기화
            document.querySelectorAll('.outcome-card').forEach(card => {
                card.classList.remove('selected', 'win', 'loss');
            });
            
            // 선택된 카드 스타일링
            const selectedCard = event.target.closest('.outcome-card');
            selectedCard.classList.add('selected');
            
            if (outcome === 'win') {
                selectedCard.classList.add('win');
                document.getElementById('win-factors').style.display = 'block';
                document.getElementById('loss-factors').style.display = 'none';
            } else if (outcome === 'loss') {
                selectedCard.classList.add('loss');
                document.getElementById('win-factors').style.display = 'none';
                document.getElementById('loss-factors').style.display = 'block';
            } else {
                document.getElementById('win-factors').style.display = 'none';
                document.getElementById('loss-factors').style.display = 'none';
            }
        }

        // 체크박스 시각적 피드백
        document.querySelectorAll('.checkbox-item input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const item = this.closest('.checkbox-item');
                if (this.checked) {
                    item.classList.add('checked');
                } else {
                    item.classList.remove('checked');
                }
            });
        });

        // 레이팅 슬라이더 업데이트
        document.querySelectorAll('input[type="range"]').forEach(slider => {
            slider.addEventListener('input', function() {
                const valueId = this.id + '-value';
                const valueDisplay = document.getElementById(valueId);
                if (valueDisplay) {
                    valueDisplay.textContent = this.value;
                }
            });
        });

        function collectFormData() {
            return {
                customerName: document.getElementById('customer-name').value,
                dealSize: parseFloat(document.getElementById('deal-size').value),
                salesCycle: parseInt(document.getElementById('sales-cycle').value),
                industry: document.getElementById('industry').value,
                salesRep: document.getElementById('sales-rep').value,
                closeDate: document.getElementById('close-date').value,
                primaryCompetitor: document.getElementById('primary-competitor').value,
                decisionMaker: document.getElementById('decision-maker').value,
                outcome: selectedOutcome,
                winFactors: collectCheckedValues('win-factors'),
                lossFactors: collectCheckedValues('loss-factors'),
                ratings: {
                    lead: parseInt(document.getElementById('rating-lead').value),
                    discovery: parseInt(document.getElementById('rating-discovery').value),
                    proposal: parseInt(document.getElementById('rating-proposal').value),
                    negotiation: parseInt(document.getElementById('rating-negotiation').value),
                    relationship: parseInt(document.getElementById('rating-relationship').value),
                    closing: parseInt(document.getElementById('rating-closing').value)
                },
                customerFeedback: document.getElementById('customer-feedback').value,
                lessonsLearned: document.getElementById('lessons-learned').value,
                nextActions: document.getElementById('next-actions').value
            };
        }

        function collectCheckedValues(sectionId) {
            const section = document.getElementById(sectionId);
            if (!section || section.style.display === 'none') return [];
            
            const checkedBoxes = section.querySelectorAll('input[type="checkbox"]:checked');
            return Array.from(checkedBoxes).map(cb => cb.value);
        }

        function analyzeDeal() {
            dealData = collectFormData();
            
            if (!dealData.customerName || !dealData.outcome) {
                alert('고객사명과 딜 결과를 입력해주세요.');
                return;
            }
            
            const analysis = generateAnalysis(dealData);
            displayAnalysis(analysis);
        }

        function generateAnalysis(data) {
            const avgRating = Object.values(data.ratings).reduce((sum, rating) => sum + rating, 0) / 6;
            
            let strengthAreas = [];
            let improvementAreas = [];
            let recommendations = [];

            // 영업 프로세스 분석
            Object.entries(data.ratings).forEach(([key, value]) => {
                const areaName = getAreaName(key);
                if (value >= 8) {
                    strengthAreas.push(`${areaName} (${value}/10)`);
                } else if (value <= 5) {
                    improvementAreas.push(`${areaName} (${value}/10)`);
                }
            });

            // 결과별 분석
            if (data.outcome === 'win') {
                recommendations = generateWinRecommendations(data);
            } else if (data.outcome === 'loss') {
                recommendations = generateLossRecommendations(data);
            } else {
                recommendations = generateNoDecisionRecommendations(data);
            }

            return {
                data,
                avgRating,
                strengthAreas,
                improvementAreas,
                recommendations
            };
        }

        function getAreaName(key) {
            const areaMap = {
                'lead': '리드 발굴',
                'discovery': 'Discovery',
                'proposal': '솔루션 제안',
                'negotiation': '가격 협상',
                'relationship': '관계 구축',
                'closing': '클로징'
            };
            return areaMap[key] || key;
        }

        function generateWinRecommendations(data) {
            const recommendations = [
                "🎉 성공을 축하합니다! 이번 성공 요인을 다른 딜에도 적용해보세요.",
                "📊 ROI 데이터를 정리하여 레퍼런스 자료로 활용하세요.",
                "🤝 고객과의 관계를 지속 유지하여 확장 기회를 모색하세요."
            ];

            // 성공 요인 기반 추천
            if (data.winFactors.includes('strong-relationship')) {
                recommendations.push("💼 관계 기반 영업이 성공했습니다. 다른 딜에서도 관계 구축에 더 많은 시간을 투자하세요.");
            }
            
            if (data.winFactors.includes('clear-roi')) {
                recommendations.push("📈 ROI 중심 접근이 효과적이었습니다. ROI 계산기 활용도를 높이세요.");
            }

            return recommendations;
        }

        function generateLossRecommendations(data) {
            const recommendations = [
                "🔍 실패 요인을 정확히 분석하여 향후 유사한 상황을 방지하세요.",
                "🤝 고객과의 관계를 유지하여 향후 기회를 모색하세요."
            ];

            // 실패 요인 기반 추천
            if (data.lossFactors.includes('price-too-high')) {
                recommendations.push("💰 가격 경쟁력이 부족했습니다. 번들 상품이나 분할 지불 등 대안을 검토하세요.");
            }
            
            if (data.lossFactors.includes('weak-relationship')) {
                recommendations.push("🤝 고객과의 관계가 부족했습니다. 초기 관계 구축에 더 많은 시간을 투자하세요.");
            }
            
            if (data.lossFactors.includes('strong-competitor')) {
                recommendations.push("⚔️ 경쟁사 대응이 필요합니다. 배틀카드를 검토하고 차별화 전략을 강화하세요.");
            }

            return recommendations;
        }

        function generateNoDecisionRecommendations(data) {
            return [
                "⏰ 의사결정이 연기되었습니다. 고객의 우선순위와 타임라인을 재확인하세요.",
                "🎯 구체적인 가치 제안을 통해 긴급성을 조성하세요.",
                "📞 정기적인 팔로우업을 통해 프로젝트를 활성 상태로 유지하세요.",
                "💡 더 작은 범위의 파일럿 프로젝트를 제안해보세요."
            ];
        }

        function displayAnalysis(analysis) {
            const resultsDiv = document.getElementById('analysisResults');
            const contentDiv = document.getElementById('analysisContent');
            
            const outcomeColor = analysis.data.outcome === 'win' ? '#48bb78' : 
                                 analysis.data.outcome === 'loss' ? '#f56565' : '#ed8936';
            const outcomeText = analysis.data.outcome === 'win' ? '성공' :
                               analysis.data.outcome === 'loss' ? '실패' : '연기';
            const outcomeIcon = analysis.data.outcome === 'win' ? '🏆' :
                               analysis.data.outcome === 'loss' ? '❌' : '⏸️';

            contentDiv.innerHTML = `
                <div class="insight-card" style="border-left-color: ${outcomeColor};">
                    <div class="insight-title" data-icon="📊">${analysis.data.customerName} 딜 분석 결과</div>
                    
                    <div class="metrics-grid">
                        <div class="metric-card" style="border-top-color: ${outcomeColor};">
                            <div class="metric-value" style="color: ${outcomeColor};">${outcomeIcon}</div>
                            <div class="metric-label">딜 결과</div>
                            <div style="font-weight: 600; color: ${outcomeColor};">${outcomeText}</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${analysis.data.dealSize || 'N/A'}억</div>
                            <div class="metric-label">딜 사이즈</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${analysis.data.salesCycle || 'N/A'}개월</div>
                            <div class="metric-label">영업 사이클</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${analysis.avgRating.toFixed(1)}</div>
                            <div class="metric-label">프로세스 점수</div>
                        </div>
                    </div>

                    ${analysis.strengthAreas.length > 0 ? `
                    <h4 style="margin: 25px 0 15px 0; color: #48bb78;">💪 강점 영역</h4>
                    <ul style="margin-bottom: 20px;">
                        ${analysis.strengthAreas.map(area => `<li>${area}</li>`).join('')}
                    </ul>
                    ` : ''}

                    ${analysis.improvementAreas.length > 0 ? `
                    <h4 style="margin: 25px 0 15px 0; color: #f56565;">🔧 개선 필요 영역</h4>
                    <ul style="margin-bottom: 20px;">
                        ${analysis.improvementAreas.map(area => `<li>${area}</li>`).join('')}
                    </ul>
                    ` : ''}

                    ${analysis.data.customerFeedback ? `
                    <h4 style="margin: 25px 0 15px 0;">💬 고객 피드백</h4>
                    <p style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-style: italic;">
                        "${analysis.data.customerFeedback}"
                    </p>
                    ` : ''}
                </div>

                <div class="action-items">
                    <div class="action-title">개선 액션 아이템</div>
                    <ul class="action-list">
                        ${analysis.recommendations.map(rec => `<li>${rec}</li>`).join('')}
                    </ul>
                </div>

                ${analysis.data.lessonsLearned ? `
                <div class="insight-card">
                    <div class="insight-title" data-icon="🎓">배운 점 및 교훈</div>
                    <p>${analysis.data.lessonsLearned}</p>
                </div>
                ` : ''}

                ${analysis.data.nextActions ? `
                <div class="insight-card">
                    <div class="insight-title" data-icon="🚀">후속 조치 계획</div>
                    <p>${analysis.data.nextActions}</p>
                </div>
                ` : ''}
            `;
            
            resultsDiv.classList.add('show');
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // 슬라이더 값 초기화
            document.querySelectorAll('input[type="range"]').forEach(slider => {
                const valueId = slider.id + '-value';
                const valueDisplay = document.getElementById(valueId);
                if (valueDisplay) {
                    valueDisplay.textContent = slider.value;
                }
            });
        });
    </script>
</body>
</html>