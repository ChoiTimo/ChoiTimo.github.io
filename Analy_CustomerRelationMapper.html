<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartWAN 고객 관계 공략 도구</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .section h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }

        .form-group select,
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group select:focus,
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .stakeholder-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #48bb78;
            position: relative;
        }

        .stakeholder-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 20px;
        }

        .stakeholder-info {
            flex: 1;
        }

        .stakeholder-name {
            font-size: 1.3em;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .stakeholder-role {
            color: #718096;
            font-size: 1.1em;
        }

        .influence-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .influence-level {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
        }

        .influence-high { background: #f56565; color: white; }
        .influence-medium { background: #ed8936; color: white; }
        .influence-low { background: #68d391; color: white; }

        .relationship-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .metric-item {
            text-align: center;
            padding: 15px;
            background: #f7fafc;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
        }

        .metric-label {
            font-size: 0.9em;
            color: #718096;
            margin-bottom: 5px;
        }

        .metric-value {
            font-size: 1.2em;
            font-weight: 700;
            color: #2d3748;
        }

        .sentiment-positive { color: #48bb78; }
        .sentiment-neutral { color: #ed8936; }
        .sentiment-negative { color: #f56565; }

        .strategy-box {
            background: #ebf8ff;
            border: 2px solid #bee3f8;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .strategy-title {
            color: #2b6cb0;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .action-items {
            background: #f0fff4;
            border: 2px solid #c6f6d5;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .action-title {
            color: #22543d;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .warning-box {
            background: #fef5e7;
            border: 2px solid #f6e05e;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .warning-title {
            color: #d69e2e;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .add-stakeholder-btn {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(72, 187, 120, 0.3);
        }

        .add-stakeholder-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(72, 187, 120, 0.4);
        }

        .analyze-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 40px auto;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .relationship-map {
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 15px;
            border: 2px solid #e2e8f0;
            display: none;
        }

        .relationship-map.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .pipeline-strategy {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
        }

        .priority-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin-left: 15px;
        }

        .priority-critical { background: #f56565; color: white; }
        .priority-high { background: #ed8936; color: white; }
        .priority-medium { background: #48bb78; color: white; }

        .champion-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #ffd700;
            color: #2d3748;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .blocker-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #f56565;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .slider-container {
            margin: 15px 0;
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: 5px;
            background: #e2e8f0;
            outline: none;
            transition: all 0.3s ease;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .delete-btn {
            background: #f56565;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            background: #e53e3e;
            transform: translateY(-1px);
        }

        @media (max-width: 768px) {
            .container {
                margin: 0;
                border-radius: 0;
            }
            
            .content {
                padding: 20px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }

            .relationship-metrics {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 SmartWAN 고객 관계 공략 도구</h1>
            <p>B2B 영업 전문가가 설계한 전략적 관계 매핑 & 공략 시스템</p>
        </div>

        <div class="content">
            <!-- 고객사 기본 정보 -->
            <div class="section">
                <h2>🏢 Target 고객사 정보</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="company">고객사명</label>
                        <input type="text" id="company" placeholder="예: 삼성전자, LG화학">
                    </div>
                    
                    <div class="form-group">
                        <label for="industry">업종</label>
                        <select id="industry">
                            <option value="">업종 선택</option>
                            <option value="manufacturing">제조업</option>
                            <option value="financial">금융업</option>
                            <option value="enterprise">기업서비스</option>
                            <option value="public">공공/준공공</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="dealSize">예상 딜 사이즈</label>
                        <select id="dealSize">
                            <option value="">딜 사이즈 선택</option>
                            <option value="small">1억 미만 (Small Deal)</option>
                            <option value="medium">1-10억 (Medium Deal)</option>
                            <option value="large">10-50억 (Large Deal)</option>
                            <option value="strategic">50억 이상 (Strategic Deal)</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="salesStage">현재 영업 단계</label>
                        <select id="salesStage">
                            <option value="">영업 단계 선택</option>
                            <option value="prospecting">Prospecting (잠재고객 발굴)</option>
                            <option value="qualifying">Qualifying (니즈 확인)</option>
                            <option value="proposing">Proposing (제안)</option>
                            <option value="negotiating">Negotiating (협상)</option>
                            <option value="closing">Closing (클로징)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="timeframe">예상 결정 시기</label>
                        <select id="timeframe">
                            <option value="">시기 선택</option>
                            <option value="immediate">1개월 내 (긴급)</option>
                            <option value="short">2-3개월 (단기)</option>
                            <option value="medium">3-6개월 (중기)</option>
                            <option value="long">6개월 이상 (장기)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="competition">주요 경쟁사</label>
                        <select id="competition">
                            <option value="">경쟁사 선택</option>
                            <option value="cisco">Cisco</option>
                            <option value="fortinet">Fortinet</option>
                            <option value="paloalto">Palo Alto</option>
                            <option value="cato">Cato Networks</option>
                            <option value="others">기타</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- 이해관계자 추가 섹션 -->
            <div class="section">
                <h2>👥 이해관계자 매핑</h2>
                <p style="margin-bottom: 20px; color: #718096;">구매 의사결정에 영향을 미치는 모든 인물을 추가하고 관계를 분석하세요.</p>
                
                <button class="add-stakeholder-btn" onclick="addStakeholder()">
                    ➕ 새 이해관계자 추가
                </button>

                <div id="stakeholdersList">
                    <!-- 이해관계자 카드들이 여기에 동적으로 추가됩니다 -->
                </div>
            </div>

            <button class="analyze-btn" onclick="analyzeRelationships()">
                🎯 관계도 분석 및 공략 전략 생성
            </button>

            <!-- 분석 결과 -->
            <div class="relationship-map" id="relationshipMap">
                <div id="analysisResults"></div>
            </div>
        </div>
    </div>

    <script>
        let stakeholderCount = 0;
        let stakeholders = [];

        function addStakeholder() {
            stakeholderCount++;
            const stakeholderId = `stakeholder_${stakeholderCount}`;
            
            const stakeholderHTML = `
                <div class="stakeholder-card" id="${stakeholderId}">
                    <div class="stakeholder-header">
                        <div class="stakeholder-info">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>이름</label>
                                    <input type="text" id="${stakeholderId}_name" placeholder="홍길동">
                                </div>
                                <div class="form-group">
                                    <label>직책/부서</label>
                                    <input type="text" id="${stakeholderId}_role" placeholder="CIO, IT본부장">
                                </div>
                            </div>
                        </div>
                        <button class="delete-btn" onclick="removeStakeholder('${stakeholderId}')">삭제</button>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>역할 유형</label>
                            <select id="${stakeholderId}_type">
                                <option value="">역할 선택</option>
                                <option value="decision_maker">최종 의사결정자 (Decision Maker)</option>
                                <option value="influencer">영향력자 (Influencer)</option>
                                <option value="user">실사용자 (End User)</option>
                                <option value="gatekeeper">관문지기 (Gatekeeper)</option>
                                <option value="champion">내부 챔피언 (Champion)</option>
                                <option value="blocker">반대자 (Blocker)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>영향력 수준</label>
                            <select id="${stakeholderId}_influence">
                                <option value="">영향력 선택</option>
                                <option value="high">High (최종 결정권)</option>
                                <option value="medium">Medium (강한 영향력)</option>
                                <option value="low">Low (의견 제시)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>우리와의 관계성</label>
                            <div class="slider-container">
                                <input type="range" min="1" max="10" value="5" class="slider" id="${stakeholderId}_intimacy">
                                <div style="display: flex; justify-content: space-between; font-size: 0.8em; color: #718096;">
                                    <span>낯선 사이 (1)</span>
                                    <span id="${stakeholderId}_intimacy_value">보통 (5)</span>
                                    <span>절친한 사이 (10)</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>우리에 대한 태도</label>
                            <select id="${stakeholderId}_sentiment">
                                <option value="">태도 선택</option>
                                <option value="supporter">적극 지지 (Supporter)</option>
                                <option value="positive">우호적 (Positive)</option>
                                <option value="neutral">중립적 (Neutral)</option>
                                <option value="skeptical">회의적 (Skeptical)</option>
                                <option value="hostile">적대적 (Hostile)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>LinkedIn/SNS 프로필</label>
                            <input type="text" id="${stakeholderId}_linkedin" placeholder="https://linkedin.com/in/profile">
                        </div>
                        
                        <div class="form-group">
                            <label>마지막 접촉일</label>
                            <input type="date" id="${stakeholderId}_lastContact">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>주요 관심사/Pain Point</label>
                        <textarea id="${stakeholderId}_interests" rows="3" placeholder="이 사람이 가장 중요하게 생각하는 것들, 해결하고 싶어하는 문제점들을 입력하세요"></textarea>
                    </div>

                    <div class="form-group">
                        <label>관계 구축 노트</label>
                        <textarea id="${stakeholderId}_notes" rows="3" placeholder="이전 미팅 내용, 개인적 정보, 관계 구축을 위한 메모 등을 입력하세요"></textarea>
                    </div>
                </div>
            `;
            
            document.getElementById('stakeholdersList').insertAdjacentHTML('beforeend', stakeholderHTML);
            
            // 슬라이더 이벤트 리스너 추가
            const slider = document.getElementById(`${stakeholderId}_intimacy`);
            const valueDisplay = document.getElementById(`${stakeholderId}_intimacy_value`);
            
            slider.addEventListener('input', function() {
                const value = this.value;
                let description = '';
                if (value <= 2) description = `낯선 사이 (${value})`;
                else if (value <= 4) description = `어색한 사이 (${value})`;
                else if (value <= 6) description = `보통 사이 (${value})`;
                else if (value <= 8) description = `친근한 사이 (${value})`;
                else description = `절친한 사이 (${value})`;
                
                valueDisplay.textContent = description;
            });
        }

        function removeStakeholder(stakeholderId) {
            const element = document.getElementById(stakeholderId);
            if (element) {
                element.remove();
            }
        }

        function collectStakeholderData() {
            const stakeholderElements = document.querySelectorAll('.stakeholder-card');
            const stakeholderData = [];
            
            stakeholderElements.forEach(element => {
                const id = element.id;
                const data = {
                    id: id,
                    name: document.getElementById(`${id}_name`).value,
                    role: document.getElementById(`${id}_role`).value,
                    type: document.getElementById(`${id}_type`).value,
                    influence: document.getElementById(`${id}_influence`).value,
                    intimacy: document.getElementById(`${id}_intimacy`).value,
                    sentiment: document.getElementById(`${id}_sentiment`).value,
                    linkedin: document.getElementById(`${id}_linkedin`).value,
                    lastContact: document.getElementById(`${id}_lastContact`).value,
                    interests: document.getElementById(`${id}_interests`).value,
                    notes: document.getElementById(`${id}_notes`).value
                };
                
                if (data.name && data.role) {
                    stakeholderData.push(data);
                }
            });
            
            return stakeholderData;
        }

        function analyzeRelationships() {
            const company = document.getElementById('company').value;
            const industry = document.getElementById('industry').value;
            const dealSize = document.getElementById('dealSize').value;
            const salesStage = document.getElementById('salesStage').value;
            const timeframe = document.getElementById('timeframe').value;
            const competition = document.getElementById('competition').value;
            
            const stakeholderData = collectStakeholderData();
            
            if (!company || stakeholderData.length === 0) {
                alert('고객사명과 최소 1명의 이해관계자 정보를 입력해주세요.');
                return;
            }
            
            // 분석 결과 생성
            const analysis = generateAnalysis(company, industry, dealSize, salesStage, timeframe, competition, stakeholderData);
            displayAnalysis(analysis);
        }

        function generateAnalysis(company, industry, dealSize, salesStage, timeframe, competition, stakeholders) {
            // 관계 분석
            const champions = stakeholders.filter(s => s.type === 'champion' || s.sentiment === 'supporter');
            const blockers = stakeholders.filter(s => s.type === 'blocker' || s.sentiment === 'hostile');
            const decisionMakers = stakeholders.filter(s => s.type === 'decision_maker');
            const influencers = stakeholders.filter(s => s.type === 'influencer');
            
            // 친밀도 분석
            const avgIntimacy = stakeholders.reduce((sum, s) => sum + parseInt(s.intimacy), 0) / stakeholders.length;
            const highIntimacy = stakeholders.filter(s => parseInt(s.intimacy) >= 7);
            const lowIntimacy = stakeholders.filter(s => parseInt(s.intimacy) <= 3);
            
            // 영향력 분석
            const highInfluence = stakeholders.filter(s => s.influence === 'high');
            const mediumInfluence = stakeholders.filter(s => s.influence === 'medium');
            
            return {
                company,
                industry,
                dealSize,
                salesStage,
                timeframe,
                competition,
                stakeholders,
                analysis: {
                    champions,
                    blockers,
                    decisionMakers,
                    influencers,
                    avgIntimacy,
                    highIntimacy,
                    lowIntimacy,
                    highInfluence,
                    mediumInfluence
                }
            };
        }

        function displayAnalysis(data) {
            const resultsDiv = document.getElementById('analysisResults');
            const analysis = data.analysis;
            
            // 위험도 계산
            let riskLevel = 'low';
            let riskColor = '#48bb78';
            let riskText = '낮음';
            
            if (analysis.blockers.length > analysis.champions.length || analysis.avgIntimacy < 4) {
                riskLevel = 'high';
                riskColor = '#f56565';
                riskText = '높음';
            } else if (analysis.champions.length === 0 || analysis.avgIntimacy < 6) {
                riskLevel = 'medium';
                riskColor = '#ed8936';
                riskText = '중간';
            }
            
            resultsDiv.innerHTML = `
                <div class="pipeline-strategy">
                    <h2 style="color: #2d3748; margin-bottom: 20px;">📊 ${data.company} 관계 분석 결과</h2>
                    
                    <div class="relationship-metrics">
                        <div class="metric-item">
                            <div class="metric-label">총 이해관계자</div>
                            <div class="metric-value">${data.stakeholders.length}명</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">내부 챔피언</div>
                            <div class="metric-value sentiment-positive">${analysis.champions.length}명</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">반대자</div>
                            <div class="metric-value sentiment-negative">${analysis.blockers.length}명</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">평균 친밀도</div>
                            <div class="metric-value">${analysis.avgIntimacy.toFixed(1)}/10</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">딜 위험도</div>
                            <div class="metric-value" style="color: ${riskColor}">${riskText}</div>
                        </div>
                    </div>
                </div>

                ${generateStakeholderStrategies(data)}
                ${generatePipelineStrategy(data)}
                ${generateActionPlan(data)}
                ${generateWarnings(data)}
            `;
            
            document.getElementById('relationshipMap').classList.add('show');
            document.getElementById('relationshipMap').scrollIntoView({ behavior: 'smooth' });
        }

        function generateStakeholderStrategies(data) {
            let strategiesHTML = '<div class="pipeline-strategy"><h3 style="color: #2d3748; margin-bottom: 20px;">🎯 개별 공략 전략</h3>';
            
            data.stakeholders.forEach(stakeholder => {
                const intimacyLevel = parseInt(stakeholder.intimacy);
                const strategy = getStakeholderStrategy(stakeholder);
                const priorityClass = getPriorityClass(stakeholder);
                const priorityText = getPriorityText(stakeholder);
                
                strategiesHTML += `
                    <div class="stakeholder-card" style="margin-bottom: 20px;">
                        ${stakeholder.type === 'champion' ? '<div class="champion-indicator">🏆 챔피언</div>' : ''}
                        ${stakeholder.type === 'blocker' ? '<div class="blocker-indicator">⚠️ 차단자</div>' : ''}
                        
                        <div class="stakeholder-name">${stakeholder.name}</div>
                        <div class="stakeholder-role">${stakeholder.role}</div>
                        <span class="priority-badge ${priorityClass}">${priorityText}</span>
                        
                        <div class="relationship-metrics" style="margin: 15px 0;">
                            <div class="metric-item">
                                <div class="metric-label">친밀도</div>
                                <div class="metric-value">${intimacyLevel}/10</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">영향력</div>
                                <div class="metric-value">${getInfluenceText(stakeholder.influence)}</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-label">태도</div>
                                <div class="metric-value ${getSentimentClass(stakeholder.sentiment)}">${getSentimentText(stakeholder.sentiment)}</div>
                            </div>
                        </div>
                        
                        <div class="strategy-box">
                            <div class="strategy-title">💡 공략 전략</div>
                            <p>${strategy.approach}</p>
                        </div>
                        
                        <div class="action-items">
                            <div class="action-title">📋 실행 액션</div>
                            <ul>
                                ${strategy.actions.map(action => `<li>${action}</li>`).join('')}
                            </ul>
                        </div>
                        
                        ${stakeholder.linkedin ? `
                        <div class="strategy-box">
                            <div class="strategy-title">🌐 LinkedIn 활용법</div>
                            <p>프로필 분석을 통해 공통 관심사나 네트워크를 찾아 자연스러운 대화 소재로 활용하세요.</p>
                            <p><strong>링크:</strong> <a href="${stakeholder.linkedin}" target="_blank">프로필 보기</a></p>
                        </div>
                        ` : ''}
                    </div>
                `;
            });
            
            strategiesHTML += '</div>';
            return strategiesHTML;
        }

        function getStakeholderStrategy(stakeholder) {
            const intimacy = parseInt(stakeholder.intimacy);
            const type = stakeholder.type;
            const sentiment = stakeholder.sentiment;
            const influence = stakeholder.influence;
            
            let approach = '';
            let actions = [];
            
            // 역할별 기본 전략
            switch(type) {
                case 'decision_maker':
                    approach = '최종 의사결정권자로서 비즈니스 임팩트와 ROI에 집중한 접근이 필요합니다. 전략적 가치와 경쟁우위를 중심으로 커뮤니케이션하세요.';
                    actions = [
                        '경영진 레벨 자료 준비 (ROI, 전략적 가치)',
                        '업계 벤치마킹 자료 제공',
                        'CEO/임원 레퍼런스 미팅 주선'
                    ];
                    break;
                case 'influencer':
                    approach = '강한 영향력을 가진 키 플레이어입니다. 기술적 우수성과 실용성을 모두 어필하며, 이 분을 통해 다른 이해관계자들에게 영향을 미치도록 해야 합니다.';
                    actions = [
                        '기술 데모 및 상세 기능 설명',
                        '동종업계 성공사례 공유',
                        '전문가 네트워킹 이벤트 초청'
                    ];
                    break;
                case 'champion':
                    approach = '우리의 강력한 지지자입니다. 이 분을 통해 내부 영향력을 확산시키고, 더 많은 정보와 인사이트를 얻어야 합니다.';
                    actions = [
                        '내부 프레젠테이션 지원 자료 제공',
                        '정기적인 업데이트 미팅',
                        '추가 인맥 소개 요청'
                    ];
                    break;
                case 'blocker':
                    approach = '반대 의견을 가진 분입니다. 우려사항을 정확히 파악하고 맞춤형 솔루션으로 설득해야 합니다. 직접적인 대결보다는 우회적 접근이 효과적입니다.';
                    actions = [
                        '구체적인 우려사항 파악',
                        '맞춤형 해결방안 제시',
                        '중립적인 제3자를 통한 간접 접근'
                    ];
                    break;
                default:
                    approach = '해당 역할에 맞는 맞춤형 접근이 필요합니다.';
                    actions = ['역할별 맞춤 전략 수립'];
            }
            
            // 친밀도에 따른 전략 조정
            if (intimacy <= 3) {
                actions.unshift('관계 구축을 위한 비공식 미팅 주선');
                actions.unshift('공통 관심사 기반 대화 소재 준비');
            } else if (intimacy >= 8) {
                actions.push('더 깊은 비즈니스 논의 진행');
                actions.push('장기적 파트너십 관점 제시');
            }
            
            // 태도에 따른 전략 조정
            if (sentiment === 'hostile' || sentiment === 'skeptical') {
                actions.unshift('신뢰 구축을 위한 소규모 PoC 제안');
            }
            
            return { approach, actions };
        }

        function generatePipelineStrategy(data) {
            const analysis = data.analysis;
            let strategy = '';
            let priority = '';
            
            if (analysis.champions.length === 0) {
                strategy = '내부 챔피언 확보가 최우선입니다. 가장 우호적인 이해관계자를 챔피언으로 전환하는데 집중하세요.';
                priority = 'critical';
            } else if (analysis.decisionMakers.length === 0 || analysis.highInfluence.length === 0) {
                strategy = '최종 의사결정권자나 고영향력자와의 접점이 부족합니다. 챔피언을 통해 소개받거나 우회 경로를 찾아야 합니다.';
                priority = 'high';
            } else if (analysis.avgIntimacy < 5) {
                strategy = '전반적인 관계 깊이가 부족합니다. 관계 구축에 더 많은 시간과 노력을 투자해야 합니다.';
                priority = 'high';
            } else {
                strategy = '관계 매트릭스가 양호합니다. 구체적인 제안과 협상 단계로 진행할 수 있습니다.';
                priority = 'medium';
            }
            
            return `
                <div class="pipeline-strategy">
                    <h3 style="color: #2d3748; margin-bottom: 15px;">🚀 전체 파이프라인 전략</h3>
                    <span class="priority-badge priority-${priority}">${getPriorityKorean(priority)}</span>
                    <p style="margin-top: 15px;">${strategy}</p>
                </div>
            `;
        }

        function generateActionPlan(data) {
            const analysis = data.analysis;
            const actions = [];
            
            // 단계별 액션 플랜
            if (analysis.champions.length === 0) {
                actions.push('1. 가장 우호적인 이해관계자 2-3명과 개별 미팅 (1주 내)');
                actions.push('2. 비공식 만남을 통한 관계 깊이 향상 (2주 내)');
                actions.push('3. 내부 상황과 의사결정 프로세스 파악 (3주 내)');
            }
            
            if (analysis.lowIntimacy.length > 0) {
                actions.push(`4. 친밀도가 낮은 핵심 인물 ${analysis.lowIntimacy.length}명과 관계 구축 집중`);
            }
            
            if (analysis.blockers.length > 0) {
                actions.push(`5. 반대자 ${analysis.blockers.length}명의 우려사항 개별 분석 및 대응 방안 수립`);
            }
            
            actions.push('6. 월 1회 정기 체크인 미팅으로 관계 지속 관리');
            actions.push('7. 분기별 관계도 업데이트 및 전략 재검토');
            
            return `
                <div class="action-items">
                    <div class="action-title">📅 30일 액션 플랜</div>
                    <ol>
                        ${actions.map(action => `<li>${action}</li>`).join('')}
                    </ol>
                </div>
            `;
        }

        function generateWarnings(data) {
            const analysis = data.analysis;
            const warnings = [];
            
            if (analysis.blockers.length > analysis.champions.length) {
                warnings.push('⚠️ 반대자가 지지자보다 많습니다. 딜 성공 확률이 낮으니 전략 재검토가 필요합니다.');
            }
            
            if (analysis.avgIntimacy < 4) {
                warnings.push('⚠️ 전반적인 관계 깊이가 부족합니다. 성급한 제안보다는 관계 구축에 먼저 집중하세요.');
            }
            
            if (analysis.decisionMakers.length === 0) {
                warnings.push('⚠️ 최종 의사결정권자와의 접점이 없습니다. 딜이 막판에 무산될 위험이 큽니다.');
            }
            
            const recentContacts = data.stakeholders.filter(s => {
                if (!s.lastContact) return false;
                const lastContact = new Date(s.lastContact);
                const monthAgo = new Date();
                monthAgo.setMonth(monthAgo.getMonth() - 1);
                return lastContact < monthAgo;
            });
            
            if (recentContacts.length > 0) {
                warnings.push(`⚠️ ${recentContacts.length}명과 한 달 이상 접촉하지 않았습니다. 관계가 소원해질 위험이 있습니다.`);
            }
            
            if (warnings.length === 0) {
                return `
                    <div class="action-items">
                        <div class="action-title">✅ 상태 점검</div>
                        <p>현재 관계 매트릭스는 건강한 상태입니다. 지속적인 관리를 통해 성공적인 딜 클로징을 위해 노력하세요.</p>
                    </div>
                `;
            }
            
            return `
                <div class="warning-box">
                    <div class="warning-title">⚠️ 주의사항</div>
                    <ul>
                        ${warnings.map(warning => `<li>${warning}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        // 유틸리티 함수들
        function getPriorityClass(stakeholder) {
            if (stakeholder.type === 'decision_maker' || stakeholder.influence === 'high') {
                return 'priority-critical';
            } else if (stakeholder.type === 'influencer' || stakeholder.influence === 'medium') {
                return 'priority-high';
            }
            return 'priority-medium';
        }

        function getPriorityText(stakeholder) {
            if (stakeholder.type === 'decision_maker' || stakeholder.influence === 'high') {
                return '최우선';
            } else if (stakeholder.type === 'influencer' || stakeholder.influence === 'medium') {
                return '중요';
            }
            return '일반';
        }

        function getPriorityKorean(priority) {
            const map = {
                'critical': '최우선',
                'high': '높음',
                'medium': '보통'
            };
            return map[priority] || '보통';
        }

        function getInfluenceText(influence) {
            const map = {
                'high': '높음',
                'medium': '중간',
                'low': '낮음'
            };
            return map[influence] || '미정';
        }

        function getSentimentClass(sentiment) {
            if (sentiment === 'supporter' || sentiment === 'positive') return 'sentiment-positive';
            if (sentiment === 'hostile' || sentiment === 'skeptical') return 'sentiment-negative';
            return 'sentiment-neutral';
        }

        function getSentimentText(sentiment) {
            const map = {
                'supporter': '적극 지지',
                'positive': '우호적',
                'neutral': '중립적',
                'skeptical': '회의적',
                'hostile': '적대적'
            };
            return map[sentiment] || '미정';
        }

        // 초기 이해관계자 1개 추가
        window.onload = function() {
            addStakeholder();
        };
    </script>
</body>
</html>